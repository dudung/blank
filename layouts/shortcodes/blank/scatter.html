{{ $w := default "70" (.Get 0) }}
{{ $h := default "300" (.Get 1) }}
{{ $r := ( .Inner | chomp) }}
{{ $seed := "foo" }}
{{ $id := delimit (shuffle (split (md5 $seed) "" )) "" }}

<div style="width: {{ $w }}%;height: {{ $h }}px;margin: 0 auto">
    <canvas id="{{ $id }}"></canvas>
</div>


<script>
function block2lists(b, eol) {
  var x = [];
  var y = [];
  
  var lines = b.split(eol);
  for(var row of lines) {
    var col = row.split(',');
    x.push(col[0]);
    y.push(col[1]);
  }
  return [x, y];
}

function block2data(b, eol) {
  let d = [];
  
  var lines = b.split(eol);
  for(var row of lines) {
    var col = row.split(',');
    var obj = {
      x: col[0],
      y: col[1]
    };
    d.push(obj);
  }
  return d;
}


var r = {{ ( .Inner | chomp) }};

var eol = '\r\n'
if(r.indexOf(eol) == -1) eol = '\r'
if(r.indexOf(eol) == -1) eol = '\n'

var lines = r.split(eol);
lines.shift();
lines = lines.join(eol);
block = lines.split(eol + eol);

var series = [];
for(b of block) {
  var d = block2data(b, eol);
  series.push(d);
}
console.log(series);

</script>


<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script type="text/javascript">
    var ctx = document.getElementById('{{ $id }}').getContext('2d');
    
    const data = {
      datasets: [
        { label: 'Data 1',
          data: series[0] /* [
            {x: -10, y: 0},
            {x: 0, y: 10},
            {x: 10, y: 5},
            {x: 0.5, y: 5.5} ] */,
          backgroundColor: 'rgb(255, 99, 132)' },
        { label: 'Data 2',
          data: series[1] /*[
            {x: 0, y: -10},
            {x: 10, y: 10},
            {x: 10, y: -5},
            {x: 0.5, y: -5.5} ] */,
          backgroundColor: 'rgb(132, 99, 255)' }
      ],
    };
    
    var config = {
      type: 'scatter',
      data: data,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            type: 'linear',
            position: 'bottom'
          }
        }
      }
    };
    
    new Chart(ctx, config);
</script>